# 004. Setting up initial form validation state

## Date: 19 Sep 2023

## Status: Accepted

## Context:

As part of League Operations, a Registration form was required. This was built
specifically for MLS Next 23/24 Season, due to time constraints.

A form structure is fetched via an API using an RTK Query.

The result of this query is then passed to a slice action, to manipulate the
data from a nested collection of `Form::Elements::`.

- A `Form::Elements::`has a `config` property.
- Within this `config` there is an `optional` property.
- Within this `config` property there may be `custom_params` property.
- Within this `custom_params` property there may be `type` property.

```
{
  id: number,
  element_type: 'Forms::Elements::Inputs::*',
  config: {
    text: string,
    data_point: false,
    element_id: string,
    custom_params: { type: 'ssn' | 'email' | phone' | 'free' | null },
    optional: boolean,
  }
  visible: true,
  order: 1,
  form_elements: [],
}
```

to convert it into an object in state as such:

```
validation: {
  status: 'PENDING' | 'VALID | 'INVALID',
  message: ?string
}
```

Initial validation is set as follows:

```
if(config.optional) return 'VALID'
return 'PENDING'
```

If the HTML element's onBlur event is triggered, the validation status wil be
changed to `INVALID` if nothing has been entered, if that element is not
optional.

In addition, a message will be set and will be displayed to the user
'element_type is required'.

## Decision:

This has been spiked and will be adopted as part of League Ops

## Consequences:

- A lot of the utility functions should be extensible to other areas where form
  parsing is required
- Additional data is not being loaded into RTK, but stored smartly and easily
  accessible by a key
