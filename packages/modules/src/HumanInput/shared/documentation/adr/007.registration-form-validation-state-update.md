# 007. Setting up initial form validation state

## Date: 19 Sep 2023

## Status: Accepted

## Context:

As part of League Operations, a Registration form was required. This was built
specifically for MLS Next 23/24 Season, due to time constraints.

A form structure is fetched via an API using an RTK Query.

The result of this query is then passed to a slice action, to manipulate the
data from a nested collection of `Form::Elements::`.

- A `Form::Elements::`has a `config` property.
- Within this `config` there is an `optional` property.
- Within this `config` property there may be `custom_params` property.
- Within this `custom_params` property there may be `type` property.

```
{
  id: number,
  element_type: 'Forms::Elements::Inputs::*',
  config: {
    text: string,
    data_point: false,
    element_id: string,
    custom_params: { type: 'ssn' | 'email' | phone' | 'free' | null },
    optional: boolean,
  }
  visible: true,
  order: 1,
  form_elements: [],
}
```

to convert it into an object in state as such:

```
validation: {
  status: 'PENDING' | 'VALID | 'INVALID',
  message: ?string
}
```

However, following discussions with BE, it is possible to POST the entire form
with the `element.id` instead of the `element.config.element_id`.

This is useful when we need to load a form that has been partially completed. An
update requires a resource id to update. A creation can accept a resource id to
create. As a result, the validation state is not stored against the element.id,
to keep it consistent

Thus, the resulting state is as such:

```
[id: number]: {
  status: 'PENDING' | 'VALID | 'INVALID',
  message: ?string
}
```

## Decision:

This has been spiked and will be adopted as part of League Ops

## Consequences:

- the work has already been carried out
