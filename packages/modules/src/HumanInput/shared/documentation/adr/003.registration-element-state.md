# 003. Addition of elements to form state

## Date: 19 Sep 2023

## Status: Accepted

## Context:

As part of League Operations, a Registration form was required. This was built
specifically for MLS Next 23/24 Season, due to time constraints.

A form structure is fetched via an API using an RTK Query.

A `Form::Elements::` may have a property `condition`.

This condition is structured as such:

```
condition: {
  element_id: reference_element_id,
  type: ConditionType,
  value: boolean,
  value_type: 'boolean' | 'string' | 'number',
}
```

When a condition is encountered, and that condition has not been satisfied, in
order to display a helpful, informative message to the user, we need to know
what message to display.

Simply displaying `reference_element_id is not valid` is not helpful to the
user.

To get around this, a `Map` was created in state to store a `Form::Elements::`
as such:

```
reference_element_id: {
  config: {
    data_point: false,
    element_id: 'reference_element_id',
    optional: true,
    text: 'Reference element id',
  },
  element_type: 'Forms::Elements::Inputs::Text',
  form_elements: [],
  id: 1,
  order: 1,
  visible: true,
},
```

Now, when we encounter a condition, and it has not been satisfied, we can simply
extract the referenced element id from state as such:

"`elements[reference_element_id].config.text` must match our element"

## Decision:

This has been spiked and will be adopted as part of League Ops

## Consequences:

- A lot of the utility functions should be extensible to other areas where form
  parsing is required
- Additional data is not being loaded into RTK, but stored smartly and easily
  accessible by a key
