# 001. Structure of Registration Form State

## Date: 15 Sep 2023

## Status: Accepted

## Context:

As part of League Operations, a Registration form was required. This was built
specifically for MLS Next 23/24 Season, due to time constraints.

Now that this feature has been delivered, there is a need to roll out
registration forms for the following scenarios:

- MLS Next 24/25 Season
- MLS Next Pro 24/25 Season
- Premier League 24/25 Season

As the current solution is not scalable and not in anyway maintainable, a
dynamic form parser is required.

Form specifications:
https://github.com/KitmanLabs/projects/blob/master/engineering/mobile/Features/Forms/JSON%20specification.md

To manage, specifically, form state, RTK is proposed and a flat form structure
will be used to manage state.

A form structure is fetched via an API using an RTK Query.

The result of this query is then passed to a slice action, to manipulate the
data from a nested collection of `Form::Elements::` as such

```
{
  id: number,
  element_type: 'Forms::Elements::Inputs::*',
  config: {
    text: 'Field title',
    data_point: false,
    element_id: 'field_key',
    optional: false,
  },
  visible: true,
  order: 1,
  form_elements: [],
}
```

to convert it into an object in state as such:

```
  form: {
    field_key: getDefaultValue()
  }
```

A recursive function iterates over the `Array` of `FormElements`, pulling out
any elements of type `Forms::Elements::Inputs::*` and if any `FormElements` of
type `Forms::Elements::Layouts::` are encountered, the form_elements is passed
to the same recursive function until all `Input` keys have been correctly mapped
to a default form state and the depth has been exhausted

## Decision:

This has been spiked and will be adopted as part of League Ops

## Consequences:

- BE work will be required to create the new API to fetch a form structure by id
- Extensive FE work will be required to make Registration more dynamic and
  generic
- A lot of the utility functions should be extensibel to other areas where form
  parsing is required
